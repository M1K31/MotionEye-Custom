# motionEye macOS Lite Configuration Template
# Optimized for Mac mini 2014 (Dual-Core i7 @ 3GHz, 16GB RAM)
# Based on motioneyeos embedded system approach

###############################################################################
# System Configuration
###############################################################################

# Daemon Configuration
daemon on
setup_mode off
process_id_file /usr/local/motioneye-lite/var/run/motion-lite.pid

# Logging (optimized for performance)
log_level 4
log_type syslog  
quiet on

###############################################################################
# Performance Optimization (Mac mini 2014 specific)
###############################################################################

# Thread model optimized for dual-core system
thread /usr/local/motioneye-lite/etc/camera-1.conf
# thread /usr/local/motioneye-lite/etc/camera-2.conf  # Uncomment for second camera

# CPU and Memory optimization
max_movie_time 0           # Disable automatic movie length limits
emulate_motion off         # Disable motion emulation for performance

###############################################################################
# Default Camera Template (camera-1.conf)
###############################################################################

# Device
videodevice /dev/video0
v4l2_palette 17           # YUYV format for better compatibility

# Image Dimensions (optimized for Mac mini 2014)
width 640                 # Lower resolution for better performance  
height 480                # 4:3 aspect ratio
framerate 15              # Reduced from 30 for CPU efficiency

# Image Quality (balanced for performance/quality)
quality 75               # JPEG quality
auto_brightness off      # Disable auto-brightness for consistency
brightness 0
contrast 0  
saturation 0
hue 0

###############################################################################
# Motion Detection (Optimized Settings)
###############################################################################

# Detection sensitivity (tuned for indoor use)
threshold 1500           # Motion detection threshold
threshold_tune on        # Auto-tune threshold
noise_level 32          # Background noise level
noise_tune on           # Auto-tune noise level

# Motion area filters
despeckle_filter EedDl   # Remove small motion artifacts
smart_mask_speed 0       # Disable smart mask for performance  
lightswitch_percent 0    # Disable light switch detection

# Detection timing
minimum_motion_frames 1  # Frames of motion required
pre_capture 0           # No pre-capture for performance
post_capture 0          # No post-capture for performance  
event_gap 10            # Seconds between events
max_changes 1000        # Max changed pixels

###############################################################################
# File Output (Optimized for Mac mini Storage)
###############################################################################

# Output directories
target_dir /usr/local/motioneye-lite/var/lib/motion
snapshot_filename %Y%m%d_%H%M%S_snapshot
picture_filename %Y%m%d_%H%M%S_%v
movie_filename %Y%m%d_%H%M%S_%v

# Picture output (disabled for performance)
output_pictures off      # Disable still image capture
output_debug_pictures off

# Movie output (optimized)
movie_output off         # Disable movie recording initially
movie_max_time 60        # Max 60-second clips if enabled
movie_quality 75         # Movie quality

###############################################################################
# Network/Streaming (Performance Optimized) 
###############################################################################

# Web control interface
webcontrol_port 8080
webcontrol_localhost off
webcontrol_html_output on

# Live streaming (optimized for local network)
stream_port 8081
stream_localhost off     # Allow remote access
stream_maxrate 5         # Limit stream rate for performance
stream_quality 50        # Lower quality for streaming
stream_grey off          # Color streaming

###############################################################################
# Database and Logging
###############################################################################

# Database (SQLite for simplicity)
database_type sqlite3
database_dbname /usr/local/motioneye-lite/var/lib/motion/motion.db
sql_log_picture off      # Disable for performance
sql_log_movie off       # Disable for performance

# Text overlay
text_left "Mac mini MotionEye Lite"
text_right %Y-%m-%d %T
text_changes off         # Disable change count overlay

###############################################################################
# Hardware Specific (Mac mini 2014)
###############################################################################

# Optimize for Intel Core i7
ffmpeg_output_movies off  # Use built-in encoder instead of FFmpeg for movies
ffmpeg_timelapse 0       # Disable timelapse
ffmpeg_variable_bitrate 0 # Fixed bitrate for consistency

# Memory management  
minimum_frame_time 0     # No artificial frame delays
roundrobin_frames 1      # Process every frame
roundrobin_skip 0        # Don't skip frames

###############################################################################
# Multi-Camera Setup (Uncomment for second camera)
###############################################################################

# For camera 2, create /usr/local/motioneye-lite/etc/camera-2.conf with:
# videodevice /dev/video1
# stream_port 8082
# webcontrol_port 8083  
# target_dir /usr/local/motioneye-lite/var/lib/motion/camera2
# All other settings same as above

###############################################################################
# Mac mini 2014 Performance Notes
###############################################################################

# Expected CPU usage per camera:
# - 640x480 @ 15fps: ~25-35% CPU per camera
# - 1280x720 @ 15fps: ~40-55% CPU per camera  
# - 1920x1080 @ 15fps: ~65-85% CPU per camera
#
# Recommended maximum:
# - 2 cameras at 640x480
# - 1 camera at 1080p with light motion detection
#
# Monitor system performance:
# - Keep total CPU under 80% sustained
# - Watch for thermal throttling
# - Check motion.log for performance warnings